<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Working with Parallel Computational Resources &mdash; OpenMDAO Documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.13.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="OpenMDAO Documentation" href="index.html" />
    <link rel="next" title="Source Documentation" href="srcdocs/index.html" />
    <link rel="prev" title="Implicit Components" href="tutorials/implicit/index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="srcdocs/index.html" title="Source Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorials/implicit/index.html" title="Implicit Components"
             accesskey="P">previous</a> |</li>
  <li><a href="http://openmdao.org">OpenMDAO Home</a> &raquo;</li>
  
        <li><a href="index.html">OpenMDAO Documentation v0.13.0</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="working-with-parallel-computational-resources">
<h1>Working with Parallel Computational Resources<a class="headerlink" href="#working-with-parallel-computational-resources" title="Permalink to this headline">¶</a></h1>
<p>Warning: This is a very advanced topic for dealing with parallel compute resources
in OpenMDAO. If you have not gone through at least our <a class="reference internal" href="basics/index.html#basic-tutorial"><em>basic tutorial</em></a>
and our <a class="reference internal" href="tutorials/optimization/index.html#optimization-tutorial"><em>optimization tutorial</em></a>, then you should become more
familiar with the foundations of OpenMDAO before delving into this section.</p>
<div class="section" id="specifying-computational-resources">
<span id="id1"></span><h2>Specifying Computational Resources<a class="headerlink" href="#specifying-computational-resources" title="Permalink to this headline">¶</a></h2>
<p>OpenMDAO uses the concept of <em>resource allocators</em> to decouple the specification
of a simulation from the computational resources it requires.  This makes
simulations more portable and also allows for the currently &#8220;best&#8221; resource
to be used.  The <a class="reference internal" href="srcdocs/packages/openmdao.main.html#id3"><em>ResourceAllocationManager</em></a> (RAM) manages
the selection of a server from one or more registered allocators.
<a class="reference internal" href="srcdocs/packages/openmdao.lib.html#id3"><em>ExternalCode</em></a>,
<a class="reference internal" href="srcdocs/packages/openmdao.lib.html#id10"><em>CaseIteratorDriver</em></a>, and
<a class="reference internal" href="srcdocs/packages/openmdao.lib.html#id15"><em>DOEdriver</em></a> are able to use this facility.</p>
<p>During ExternalCode execution, if the instance has an empty <tt class="docutils literal"><span class="pre">resources</span></tt>
dictionary, then the external code is run locally and started directly by the
ExternalCode instance.  If, however, the <tt class="docutils literal"><span class="pre">resources</span></tt> dictionary is not empty,
then it is used to allocate a server process which can support the resource
request.  This allocation process is performed by the RAM.  Once a suitable
server is found, the ExternalCode instance will send any input files to the
server, invoke <tt class="docutils literal"><span class="pre">execute_command()</span></tt> on the server, and then retrieve any output
files.</p>
<p>During CaseIteratorDriver or DOEdriver execution, a resource allocation is
performed for each case to be evaluated (unless sequential execution is
specified).  Once the server is allocated, the sub-model egg is loaded into the
server, input variables are set, the model is run, and outputs are retrieved.
The resource allocator normally just looks for a compatible server based on
the sub-model&#8217;s Python requirements, but you can add additional resource
information via the <tt class="docutils literal"><span class="pre">extra_resources</span></tt> attribute. The RAM method
<a class="reference internal" href="srcdocs/packages/openmdao.main.html#id3"><em>max_request()</em></a> can be useful for generating the
<tt class="docutils literal"><span class="pre">extra_resources</span></tt> attribute value when the sub-model contains resource
descriptions (for example, when the sub-model contains a wrapper for a parallel
CFD code).
In some circumstances, particularly when submitting from a Windows client to a
Linux server (or vice-versa), there will be spurious Python incompatibilities.
You can try forcing a submission by setting the <tt class="docutils literal"><span class="pre">ignore_egg_requirements</span></tt>
attribute to True.</p>
<p>There are several OpenMDAO resource allocators available:</p>
<dl class="docutils">
<dt><a class="reference internal" href="srcdocs/packages/openmdao.main.html#id3"><em>LocalAllocator</em></a></dt>
<dd>This is the default.  It returns server processes on the local host.
The RAM is initialized with one of these, named <tt class="docutils literal"><span class="pre">LocalHost</span></tt>.</dd>
<dt><a class="reference internal" href="srcdocs/packages/openmdao.main.html#id3"><em>RemoteAllocator</em></a></dt>
<dd>This is a proxy for an allocator on a remote host.  It is typically
created by <tt class="docutils literal"><span class="pre">RAM.add_remotes(server)</span></tt>, providing the local RAM access to
all allocators defined in the remote server&#8217;s RAM.  Note that OpenMDAO
servers can be accessed through an SSH tunnel.  So if a system is behind
a firewall that allows SSH tunneling, its allocators may be added to the
local RAM.</dd>
<dt><a class="reference internal" href="srcdocs/packages/openmdao.main.html#id3"><em>ClusterAllocator</em></a></dt>
<dd>This allocator selects from a collection of dynamically started host
servers via their respective <tt class="docutils literal"><span class="pre">LocalHost</span></tt> allocators.</dd>
<dt><a class="reference internal" href="srcdocs/packages/openmdao.main.html#id1"><em>GridEngine</em></a></dt>
<dd>This allocator returns servers which use the GridEngine <tt class="docutils literal"><span class="pre">qsub</span></tt> command
when <tt class="docutils literal"><span class="pre">execute_command()</span></tt> is invoked.</dd>
<dt><a class="reference internal" href="srcdocs/packages/openmdao.main.html#id2"><em>PBS</em></a></dt>
<dd>This allocator returns servers which use the PBS <tt class="docutils literal"><span class="pre">qsub</span></tt> command
when <tt class="docutils literal"><span class="pre">execute_command()</span></tt> is invoked.</dd>
</dl>
<p>Since some types of allocated servers are capable of submitting jobs to queuing
systems, a resource description is a dictionary that can include both
allocation and queuing information.  Allocation keys are used to find suitable
servers while queuing keys are used to describe the job to be submitted.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="8%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Allocation Key</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allocator</span></tt></td>
<td>string</td>
<td>Name of allocator to use</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">localhost</span></tt></td>
<td>bool</td>
<td>Must be/must not be on the local host</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">exclude</span></tt></td>
<td>list</td>
<td>Hostnames to exclude</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">required_distributions</span></tt></td>
<td>list</td>
<td>List of <tt class="xref py py-class docutils literal"><span class="pre">pkg_resources.Distribution</span></tt>
or package requirement strings</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">orphan_modules</span></tt></td>
<td>list</td>
<td>List of &#8220;orphan&#8221; module names</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">python_version</span></tt></td>
<td>string</td>
<td>Python version required (e.g., &#8220;2.7&#8221;)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">python_platform</span></tt></td>
<td>string</td>
<td>Python platform required (e.g., &#8220;linux-x86_64&#8221;)</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">min_cpus</span></tt></td>
<td>int</td>
<td>Minimum number of CPUs/cores required</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">max_cpus</span></tt></td>
<td>int</td>
<td>Maximum number of CPUs/cores that can be used</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">min_phys_memory</span></tt></td>
<td>int</td>
<td>Minimum amount of memory required (KB)</td>
</tr>
</tbody>
</table>
<p>Values for <tt class="docutils literal"><span class="pre">required_distributions</span></tt> and <tt class="docutils literal"><span class="pre">orphan_modules</span></tt> are typically taken
from the return value of <tt class="xref py py-meth docutils literal"><span class="pre">component.save_to_egg()</span></tt>.
The value for <tt class="docutils literal"><span class="pre">python_platform</span></tt> is typically taken from the return value of
<tt class="xref py py-meth docutils literal"><span class="pre">distutils.util.get_platform()</span></tt>.
The <tt class="docutils literal"><span class="pre">min_phys_memory</span></tt> key is also used as a queuing key.
The <tt class="docutils literal"><span class="pre">min_cpus</span></tt> and <tt class="docutils literal"><span class="pre">max_cpus</span></tt> keys are also used as queuing keys for parallel
applications. They are analogous to the DRMAA (Distributed Resource Management
Application API) <tt class="docutils literal"><span class="pre">minSlots</span></tt> and <tt class="docutils literal"><span class="pre">maxSlots</span></tt> attributes, with the intent that a &#8220;cpu&#8221; can execute an MPI process
(A DRMAA &#8220;slot&#8221; is opaque and can have different interpretations).</p>
<p>Most of the queuing keys are derived from the DRMAA standard <tt class="docutils literal"><span class="pre">JobTemplate</span></tt>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="10%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Queuing Key</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">remote_command</span></tt></td>
<td>string</td>
<td>Command to execute
(just the command, no arguments)</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">args</span></tt></td>
<td>list</td>
<td>Arguments for the command</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">submit_as_hold</span></tt></td>
<td>bool</td>
<td>Submit job to start in <tt class="docutils literal"><span class="pre">HOLD</span></tt> state</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rerunnable</span></tt></td>
<td>bool</td>
<td>Job is rerunnable (default False)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">job_environment</span></tt></td>
<td>dict</td>
<td>Any additional environment variables needed</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">working_directory</span></tt></td>
<td>string</td>
<td>Directory to execute in (use with care)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">job_category</span></tt></td>
<td>string</td>
<td>Type of job, useful for parallel codes</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">email</span></tt></td>
<td>list</td>
<td>List of email addresses to notify</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">email_on_started</span></tt></td>
<td>bool</td>
<td>Notify when jobs starts</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">email_on_terminated</span></tt></td>
<td>bool</td>
<td>Notify when job terminates</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">job_name</span></tt></td>
<td>string</td>
<td>Name for the submitted job</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">input_path</span></tt></td>
<td>string</td>
<td>Path for stdin</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">output_path</span></tt></td>
<td>string</td>
<td>Path for stdout</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">error_path</span></tt></td>
<td>string</td>
<td>Path for stderr</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">join_files</span></tt></td>
<td>bool</td>
<td>If True, stderr is joined with stdout</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">reservation_id</span></tt></td>
<td>string</td>
<td>ID of reservation (obtained externally)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">queue_name</span></tt></td>
<td>string</td>
<td>Name of queue to use</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">priority</span></tt></td>
<td>int</td>
<td>Queuing priority</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">start_time</span></tt></td>
<td>datetime</td>
<td>Timestamp for when to start the job</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">deadline_time</span></tt></td>
<td>datetime</td>
<td>Timestamp for when the job must be complete</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">resource_limits</span></tt></td>
<td>dict</td>
<td>Job resource limits (see below)</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">accounting_id</span></tt></td>
<td>string</td>
<td>ID used for job accounting</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">native_specification</span></tt></td>
<td>list</td>
<td>Queuing system specific options</td>
</tr>
</tbody>
</table>
<p>Using <tt class="docutils literal"><span class="pre">native_specification</span></tt> is discouraged since that makes the submitting
application less portable. However, at times its use is necessary in order to access specific
features of a queuing system.</p>
<p>DRMAA derived job categories:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">Environment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MPI</span></tt></td>
<td>Any MPI environment</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GridMPI</span></tt></td>
<td>A GridMPI environment</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">LAM-MPI</span></tt></td>
<td>A LAM/MPI environment</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">MPICH1</span></tt></td>
<td>A MPICH version 1 environment</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MPICH2</span></tt></td>
<td>A MPICH version 2 environment</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">OpenMPI</span></tt></td>
<td>A OpenMPI environment</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PVM</span></tt></td>
<td>A PVM environment</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">OpenMP</span></tt></td>
<td>A OpenMP environment</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">OpenCL</span></tt></td>
<td>A OpenCL environment</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Java</span></tt></td>
<td>A Java environment</td>
</tr>
</tbody>
</table>
<p>DRMAA derived resource limits:</p>
<table border="1" class="docutils">
<colgroup>
<col width="78%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">core_file_size</span></tt></td>
<td>Soft</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">data_seg_size</span></tt></td>
<td>Soft</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">file_size</span></tt></td>
<td>Soft</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">open_files</span></tt></td>
<td>Soft</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">stack_size</span></tt></td>
<td>Soft</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">virtual_memory</span></tt></td>
<td>Soft</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cpu_time</span></tt></td>
<td>Hard</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">wallclock_time</span></tt></td>
<td>Hard</td>
</tr>
</tbody>
</table>
<p>Soft limits do not affect scheduling decisions.
Hard limits may be used for scheduling.</p>
<p>Times are in seconds.</p>
<p>The <tt class="docutils literal"><span class="pre">HOME_DIRECTORY</span></tt> and <tt class="docutils literal"><span class="pre">WORKING_DIRECTORY</span></tt> constants in
<a class="reference internal" href="srcdocs/packages/openmdao.main.html#module-openmdao.main.resource" title="openmdao.main.resource"><tt class="xref py py-mod docutils literal"><span class="pre">openmdao.main.resource</span></tt></a> may be used as placeholders in path
specifications. They are translated at the server.</p>
<p>Not all resource allocators support all the features listed above. Consult the allocator
documentation to see what is supported and to find out how the
features are translated to the system the allocator interfaces with.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<a href="http://openmdao.org">
 <img src="_static/OpenMDAO_Logo_200w_padded.png"
border="0" alt="OpenMDAO Home"/>
</a>

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Working with Parallel Computational Resources</a><ul>
<li><a class="reference internal" href="#specifying-computational-resources">Specifying Computational Resources</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorials/implicit/index.html"
                        title="previous chapter">Implicit Components</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="srcdocs/index.html"
                        title="next chapter">Source Documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/concurrent.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="srcdocs/index.html" title="Source Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorials/implicit/index.html" title="Implicit Components"
             >previous</a> |</li>
  <li><a href="http://openmdao.org">OpenMDAO Home</a> &raquo;</li>
  
        <li><a href="index.html">OpenMDAO Documentation v0.13.0</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright none.
      Last updated on Apr 23, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>